# 2D Fighter 技术栈详解

## 概述

本文档详细介绍2D Fighter项目中使用的所有技术、框架和工具库。

## 客户端技术栈

### 核心引擎

#### Unity 2022.3 LTS
- **版本**：2022.3 LTS
- **用途**：游戏引擎，提供渲染、物理、动画等核心功能
- **选择理由**：
  - 成熟的2D游戏开发支持
  - 丰富的插件生态
  - 跨平台发布能力
  - 良好的性能和稳定性

### 编程语言

#### C# (.NET Standard 2.1)
- **用途**：客户端和服务器开发语言
- **特性**：
  - 强类型语言，减少运行时错误
  - 丰富的标准库
  - 良好的性能
  - 双端代码共享

### 资源管理

#### YooAsset 2.3.2-preview
- **用途**：资源管理和热更新系统
- **功能**：
  - 资源加载和卸载
  - AB包管理
  - 热更新支持
  - 资源加密
- **优势**：
  - 轻量级
  - 易于集成
  - 性能优秀

#### Addressables 1.21.21
- **用途**：Unity官方资源管理系统
- **功能**：
  - 资源异步加载
  - 内存管理
  - 远程资源加载

### 配置管理

#### Luban
- **仓库**：https://gitee.com/focus-creative-games/luban_unity.git
- **用途**：游戏配置表生成工具
- **功能**：
  - Excel/JSON/XML转配置代码
  - 多语言支持
  - 数据验证
  - 代码自动生成
- **优势**：
  - 配置即代码，强类型检查
  - 支持复杂数据结构
  - 高性能

### UI框架

#### Unity UGUI 1.0.0
- **用途**：用户界面系统
- **功能**：
  - UI布局
  - 事件处理
  - Canvas渲染

#### TextMeshPro 3.0.6
- **用途**：高质量文本渲染
- **功能**：
  - 更好的文本渲染效果
  - 字体资源管理
  - 富文本支持

### 动画与特效

#### DOTween
- **用途**：补间动画库
- **功能**：
  - 简洁的API
  - 高性能
  - 丰富的缓动函数
  - 序列动画支持

#### Cinemachine 2.9.7
- **用途**：智能相机系统
- **功能**：
  - 相机跟随
  - 镜头切换
  - 画面震动
  - 虚拟相机

#### Timeline 1.7.6
- **用途**：时间轴编辑器
- **功能**：
  - 过场动画
  - 技能序列
  - 事件触发

### 异步编程

#### UniTask
- **用途**：高性能异步/等待实现
- **功能**：
  - 零GC分配的async/await
  - 与Unity生命周期集成
  - 取消令牌支持
  - 异步LINQ
- **优势**：
  - 比Unity Coroutine更高效
  - 更好的错误处理
  - 现代化的异步编程体验

#### UniRx
- **用途**：响应式编程扩展
- **功能**：
  - 事件流处理
  - 响应式数据绑定
  - 操作符组合
- **使用场景**：
  - UI事件处理
  - 数据流转换
  - 异步操作组合

### 网络相关

#### Photon Quantum
- **用途**：确定性网络物理引擎
- **功能**：
  - 帧同步
  - 确定性物理
  - 回滚机制
  - 预测和插值
- **应用**：
  - 战斗系统的物理模拟
  - 保证多客户端一致性

#### Photon Realtime
- **用途**：实时多人游戏网络库
- **功能**：
  - 房间管理
  - 匹配系统
  - 实时消息

### 输入系统

#### Unity Input System 1.7.0
- **用途**：新版输入管理系统
- **功能**：
  - 多设备支持
  - 输入映射
  - 动作系统
  - 本地多人支持

### 开发工具

#### ParrelSync
- **仓库**：https://github.com/VeriorPies/ParrelSync.git
- **用途**：Unity项目克隆工具
- **功能**：
  - 创建项目副本用于多人测试
  - 独立运行实例
  - 本地多人调试

#### Rider 3.0.36
- **用途**：JetBrains IDE支持
- **功能**：
  - 代码智能提示
  - 重构工具
  - 调试支持

#### Visual Studio 2.0.22
- **用途**：微软IDE支持
- **功能**：
  - 代码编辑
  - 调试
  - 性能分析

### UI组件

#### EnhancedScroller
- **用途**：高性能列表滚动组件
- **功能**：
  - 虚拟化列表
  - 对象池优化
  - 流畅滚动
- **使用场景**：
  - 排行榜
  - 背包系统
  - 聊天记录

### 2D工具集

#### Unity 2D Feature 2.0.0
- **用途**：2D游戏开发工具集
- **包含**：
  - 2D Animation
  - 2D Sprite
  - 2D Tilemap
  - 2D Physics

## 服务器技术栈

### 运行时环境

#### .NET 6.0+
- **用途**：服务器运行时
- **特性**：
  - 高性能
  - 跨平台
  - 现代化C#特性
  - AOT编译支持

### 网络通信

#### KCP (自实现)
- **位置**：Server/LatServer/LatNet
- **用途**：可靠UDP传输协议
- **特性**：
  - 低延迟
  - 可靠传输
  - 拥塞控制
  - ARQ机制
- **优势**：
  - 比TCP延迟更低
  - 比UDP更可靠
  - 适合实时游戏

#### Protobuf (Protocol Buffers)
- **用途**：数据序列化协议
- **特性**：
  - 二进制格式，体积小
  - 强类型
  - 向后兼容
  - 跨语言支持
- **应用**：
  - 网络消息序列化
  - 配置数据存储

### 核心库

#### LatNet
- **用途**：网络通信层封装
- **功能**：
  - KCP会话管理
  - 连接处理
  - 心跳机制
  - 断线重连

#### LatProtocol
- **用途**：协议定义和处理
- **功能**：
  - 协议ID映射
  - 消息序列化/反序列化
  - 协议分发
  - 错误码定义

## 公共工具库

### 定点数库

#### FixedNum
- **位置**：Md/PublicLib/FixedNum
- **用途**：确定性数学计算
- **功能**：
  - 定点数运算
  - 避免浮点数误差
  - 保证多端计算一致性
- **应用场景**：
  - 战斗伤害计算
  - 位置同步
  - 物理模拟

### 计时器

#### Timer
- **位置**：Md/PublicLib/Timer
- **用途**：游戏计时器系统
- **功能**：
  - 倒计时
  - 延迟执行
  - 周期执行
  - 帧更新
- **双端支持**：客户端和服务器均可使用

## 数据结构

### 自定义数据结构
- **LATLinkedList**：链表实现
- **ConfigVar**：配置变量容器
- **ObjectPool**：对象池
- **ListPool**：列表对象池
- **WeightedRandom**：权重随机

## 开发工具链

### 版本控制
- **Git**：代码版本管理
- **GitHub**：代码托管

### 构建工具
- **Unity Build Pipeline**：客户端构建
- **MSBuild / dotnet CLI**：服务器构建

### 协议生成
- **protoc**：Protobuf编译器
- **自定义生成脚本**：协议代码自动生成

### 配置生成
- **Luban工具链**：配置表生成

## 测试框架

#### Unity Test Framework 1.1.33
- **用途**：单元测试和集成测试
- **功能**：
  - PlayMode测试
  - EditMode测试
  - 性能测试

## 技术选型原则

1. **性能优先**：选择高性能的库和框架
2. **稳定可靠**：优先使用成熟稳定的技术
3. **易于维护**：代码清晰，文档完善
4. **社区活跃**：有良好的社区支持
5. **跨平台**：支持多平台部署
6. **可扩展性**：便于后续功能扩展

## 技术债务管理

- 定期更新依赖版本
- 移除未使用的包
- 重构老旧代码
- 性能优化迭代

## 相关文档

- [项目总览](01-项目总览.md)
- [客户端架构](03-客户端架构.md)
- [服务端架构](04-服务端架构.md)
